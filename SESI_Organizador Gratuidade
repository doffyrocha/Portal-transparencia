import pandas as pd

# === CONFIGURAÇÕES ===
ARQUIVO_ORIGINAL = "gratuidade_sesi_vagas.xlsx"
ARQUIVO_SAIDA = "gratuidade_sesi_vagas_reorganizada.xlsx"

# Lê o arquivo Excel
df = pd.read_excel(ARQUIVO_ORIGINAL)

# Verifica se a coluna 'Hora-Aluno Outros' existe
if "Hora-Aluno Outros" not in df.columns:
    raise ValueError("A coluna 'Hora-Aluno Outros' não foi encontrada no arquivo.")

# Cria uma cópia do DataFrame original para gerar as linhas de 'Outros'
df_outros = df.copy()

# Define os campos de Programa e Modalidade para os novos registros
df_outros["Programa"] = "Outros Programas"
df_outros["Modalidade"] = "Outras Modalidades"

# Lista de colunas que devem ser zeradas (caso existam no arquivo)
cols_zerar = [
    "Código Programa",
    "Código Modalidade",
    "Quantidade Planejada",
    "Quantidade Realizada",
    "Hora-Aluno Gratuita",
    "Hora-Aluno Não Gratuita",
    "Total Hora-Aluno",
    "Porcentagem Gratuita (%)",
    "Total Gratuita",
    "Total Não Gratuita",
    "Total Hora-Aluno Realizada"
]

# Zera os valores dessas colunas nos registros 'Outros'
for col in cols_zerar:
    if col in df_outros.columns:
        df_outros[col] = 0

# Mantém os valores de 'Hora-Aluno Outros' apenas no df_outros
# e zera essa coluna no DataFrame original
df["Hora-Aluno Outros"] = 0

# Junta os dois DataFrames (original + outros)
df_final = pd.concat([df, df_outros], ignore_index=True)

# Salva o resultado em novo arquivo Excel
df_final.to_excel(ARQUIVO_SAIDA, index=False)

print(f"✅ Arquivo '{ARQUIVO_SAIDA}' criado com sucesso!")
